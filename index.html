
     1	<!DOCTYPE html>
     2	<html lang="he" dir="rtl">
     3	<head>
     4	    <meta charset="UTF-8">
     5	    <meta name="viewport" content="width=device-width, initial-scale=1.0">
     6	    <title>×¨×©×™××ª ×§× ×™×•×ª ××©×¤×—×ª×™×ª</title>
     7	    <style>
     8	        * {
     9	            margin: 0;
    10	            padding: 0;
    11	            box-sizing: border-box;
    12	        }
    13	
    14	        body {
    15	            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    16	            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    17	            min-height: 100vh;
    18	            padding: 20px;
    19	            direction: rtl;
    20	        }
    21	
    22	        .container {
    23	            max-width: 900px;
    24	            margin: 0 auto;
    25	            background: white;
    26	            border-radius: 20px;
    27	            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
    28	            overflow: hidden;
    29	        }
    30	
    31	        header {
    32	            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    33	            color: white;
    34	            padding: 30px;
    35	            text-align: center;
    36	        }
    37	
    38	        h1 {
    39	            font-size: 2.5em;
    40	            margin-bottom: 10px;
    41	        }
    42	
    43	        .subtitle {
    44	            opacity: 0.9;
    45	            font-size: 1.1em;
    46	        }
    47	
    48	        .stats {
    49	            display: flex;
    50	            justify-content: space-around;
    51	            padding: 20px;
    52	            background: #f8f9fa;
    53	            border-bottom: 2px solid #e9ecef;
    54	        }
    55	
    56	        .stat-item {
    57	            text-align: center;
    58	        }
    59	
    60	        .stat-number {
    61	            font-size: 2em;
    62	            font-weight: bold;
    63	            color: #667eea;
    64	        }
    65	
    66	        .stat-label {
    67	            color: #6c757d;
    68	            font-size: 0.9em;
    69	            margin-top: 5px;
    70	        }
    71	
    72	        .add-section {
    73	            padding: 30px;
    74	            background: #f8f9fa;
    75	            border-bottom: 2px solid #e9ecef;
    76	        }
    77	
    78	        .form-group {
    79	            margin-bottom: 20px;
    80	        }
    81	
    82	        label {
    83	            display: block;
    84	            margin-bottom: 8px;
    85	            font-weight: 600;
    86	            color: #495057;
    87	        }
    88	
    89	        input, select {
    90	            width: 100%;
    91	            padding: 12px;
    92	            border: 2px solid #e9ecef;
    93	            border-radius: 10px;
    94	            font-size: 16px;
    95	            transition: all 0.3s;
    96	            font-family: inherit;
    97	        }
    98	
    99	        input:focus, select:focus {
   100	            outline: none;
   101	            border-color: #667eea;
   102	            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
   103	        }
   104	
   105	        .btn {
   106	            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
   107	            color: white;
   108	            border: none;
   109	            padding: 15px 30px;
   110	            border-radius: 10px;
   111	            font-size: 16px;
   112	            font-weight: 600;
   113	            cursor: pointer;
   114	            width: 100%;
   115	            transition: transform 0.2s, box-shadow 0.2s;
   116	        }
   117	
   118	        .btn:hover {
   119	            transform: translateY(-2px);
   120	            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.3);
   121	        }
   122	
   123	        .btn:active {
   124	            transform: translateY(0);
   125	        }
   126	
   127	        .filters {
   128	            padding: 20px 30px;
   129	            background: white;
   130	            border-bottom: 2px solid #e9ecef;
   131	            display: flex;
   132	            gap: 15px;
   133	            flex-wrap: wrap;
   134	        }
   135	
   136	        .filter-group {
   137	            flex: 1;
   138	            min-width: 200px;
   139	        }
   140	
   141	        .items-section {
   142	            padding: 30px;
   143	            max-height: 600px;
   144	            overflow-y: auto;
   145	        }
   146	
   147	        .category-group {
   148	            margin-bottom: 30px;
   149	        }
   150	
   151	        .category-header {
   152	            display: flex;
   153	            align-items: center;
   154	            gap: 10px;
   155	            padding: 15px;
   156	            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
   157	            border-radius: 10px;
   158	            margin-bottom: 15px;
   159	            font-weight: 600;
   160	            font-size: 1.2em;
   161	        }
   162	
   163	        .category-icon {
   164	            font-size: 1.5em;
   165	        }
   166	
   167	        .category-count {
   168	            margin-right: auto;
   169	            background: white;
   170	            padding: 5px 15px;
   171	            border-radius: 20px;
   172	            font-size: 0.9em;
   173	            color: #667eea;
   174	        }
   175	
   176	        .item {
   177	            display: flex;
   178	            align-items: center;
   179	            gap: 15px;
   180	            padding: 15px;
   181	            background: white;
   182	            border: 2px solid #e9ecef;
   183	            border-radius: 10px;
   184	            margin-bottom: 10px;
   185	            transition: all 0.3s;
   186	        }
   187	
   188	        .item:hover {
   189	            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
   190	            transform: translateY(-2px);
   191	        }
   192	
   193	        .item.purchased {
   194	            opacity: 0.6;
   195	            background: #f8f9fa;
   196	        }
   197	
   198	        .item.purchased .item-name {
   199	            text-decoration: line-through;
   200	        }
   201	
   202	        .item-checkbox {
   203	            width: 24px;
   204	            height: 24px;
   205	            cursor: pointer;
   206	        }
   207	
   208	        .item-details {
   209	            flex: 1;
   210	        }
   211	
   212	        .item-name {
   213	            font-weight: 600;
   214	            font-size: 1.1em;
   215	            color: #212529;
   216	            margin-bottom: 5px;
   217	        }
   218	
   219	        .item-meta {
   220	            display: flex;
   221	            gap: 15px;
   222	            color: #6c757d;
   223	            font-size: 0.9em;
   224	        }
   225	
   226	        .item-meta span {
   227	            display: flex;
   228	            align-items: center;
   229	            gap: 5px;
   230	        }
   231	
   232	        .delete-btn {
   233	            background: #dc3545;
   234	            color: white;
   235	            border: none;
   236	            padding: 10px 20px;
   237	            border-radius: 8px;
   238	            cursor: pointer;
   239	            font-weight: 600;
   240	            transition: background 0.3s;
   241	        }
   242	
   243	        .delete-btn:hover {
   244	            background: #c82333;
   245	        }
   246	
   247	        .clear-section {
   248	            padding: 20px 30px;
   249	            background: #f8f9fa;
   250	            border-top: 2px solid #e9ecef;
   251	            text-align: center;
   252	        }
   253	
   254	        .clear-btn {
   255	            background: #28a745;
   256	            color: white;
   257	            border: none;
   258	            padding: 12px 30px;
   259	            border-radius: 10px;
   260	            font-size: 16px;
   261	            font-weight: 600;
   262	            cursor: pointer;
   263	            transition: background 0.3s;
   264	        }
   265	
   266	        .clear-btn:hover {
   267	            background: #218838;
   268	        }
   269	
   270	        .empty-state {
   271	            text-align: center;
   272	            padding: 60px 20px;
   273	            color: #6c757d;
   274	        }
   275	
   276	        .empty-state-icon {
   277	            font-size: 4em;
   278	            margin-bottom: 20px;
   279	            opacity: 0.3;
   280	        }
   281	
   282	        .toast {
   283	            position: fixed;
   284	            bottom: 30px;
   285	            left: 50%;
   286	            transform: translateX(-50%);
   287	            background: #28a745;
   288	            color: white;
   289	            padding: 15px 30px;
   290	            border-radius: 10px;
   291	            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
   292	            z-index: 1000;
   293	            animation: slideUp 0.3s ease-out;
   294	        }
   295	
   296	        .toast.error {
   297	            background: #dc3545;
   298	        }
   299	
   300	        @keyframes slideUp {
   301	            from {
   302	                transform: translateX(-50%) translateY(100px);
   303	                opacity: 0;
   304	            }
   305	            to {
   306	                transform: translateX(-50%) translateY(0);
   307	                opacity: 1;
   308	            }
   309	        }
   310	
   311	        .sync-status {
   312	            text-align: center;
   313	            padding: 10px;
   314	            background: #d4edda;
   315	            color: #155724;
   316	            font-weight: 600;
   317	            border-top: 2px solid #c3e6cb;
   318	        }
   319	
   320	        .sync-status.syncing {
   321	            background: #fff3cd;
   322	            color: #856404;
   323	        }
   324	
   325	        .sync-status.error {
   326	            background: #f8d7da;
   327	            color: #721c24;
   328	        }
   329	
   330	        @media (max-width: 768px) {
   331	            h1 {
   332	                font-size: 2em;
   333	            }
   334	
   335	            .stats {
   336	                flex-direction: column;
   337	                gap: 15px;
   338	            }
   339	
   340	            .filters {
   341	                flex-direction: column;
   342	            }
   343	
   344	            .item {
   345	                flex-direction: column;
   346	                align-items: flex-start;
   347	            }
   348	
   349	            .delete-btn {
   350	                width: 100%;
   351	            }
   352	        }
   353	
   354	        .loading {
   355	            text-align: center;
   356	            padding: 40px;
   357	            color: #667eea;
   358	            font-size: 1.2em;
   359	        }
   360	
   361	        .loading:after {
   362	            content: '...';
   363	            animation: dots 1.5s steps(4, end) infinite;
   364	        }
   365	
   366	        @keyframes dots {
   367	            0%, 20% {
   368	                content: '.';
   369	            }
   370	            40% {
   371	                content: '..';
   372	            }
   373	            60%, 100% {
   374	                content: '...';
   375	            }
   376	        }
   377	    </style>
   378	</head>
   379	<body>
   380	    <div class="container">
   381	        <header>
   382	            <h1>ğŸ›’ ×¨×©×™××ª ×§× ×™×•×ª ××©×¤×—×ª×™×ª</h1>
   383	            <p class="subtitle">× ×™×”×•×œ ×—×›× ×•× ×•×— ×œ×§× ×™×•×ª ×”××©×¤×—×”</p>
   384	        </header>
   385	
   386	        <div class="stats">
   387	            <div class="stat-item">
   388	                <div class="stat-number" id="totalItems">0</div>
   389	                <div class="stat-label">×¤×¨×™×˜×™× ×›×•×œ×œ</div>
   390	            </div>
   391	            <div class="stat-item">
   392	                <div class="stat-number" id="pendingItems">0</div>
   393	                <div class="stat-label">×œ×§× ×•×ª</div>
   394	            </div>
   395	            <div class="stat-item">
   396	                <div class="stat-number" id="purchasedItems">0</div>
   397	                <div class="stat-label">× ×¨×›×©×•</div>
   398	            </div>
   399	        </div>
   400	
   401	        <div class="add-section">
   402	            <form id="addItemForm">
   403	                <div class="form-group">
   404	                    <label for="itemName">×©× ×”××•×¦×¨</label>
   405	                    <input type="text" id="itemName" placeholder="×œ×“×•×’××”: ×—×œ×‘" required>
   406	                </div>
   407	                <div class="form-group">
   408	                    <label for="itemCategory">×§×˜×’×•×¨×™×”</label>
   409	                    <select id="itemCategory" required>
   410	                        <option value="">×‘×—×¨ ×§×˜×’×•×¨×™×”</option>
   411	                        <option value="×¤×™×¨×•×ª ×•×™×¨×§×•×ª">ğŸ¥¬ ×¤×™×¨×•×ª ×•×™×¨×§×•×ª</option>
   412	                        <option value="×—×œ×‘ ×•×‘×™×¦×™×">ğŸ¥› ×—×œ×‘ ×•×‘×™×¦×™×</option>
   413	                        <option value="×‘×©×¨ ×•×“×’×™×">ğŸ– ×‘×©×¨ ×•×“×’×™×</option>
   414	                        <option value="×××¤×™× ×•×œ×—×">ğŸ ×××¤×™× ×•×œ×—×</option>
   415	                        <option value="×™×‘×©×™× ×•×©×™××•×¨×™×">ğŸ¥« ×™×‘×©×™× ×•×©×™××•×¨×™×</option>
   416	                        <option value="×§×¤×•××™×">ğŸ§Š ×§×¤×•××™×</option>
   417	                        <option value="××©×§××•×ª">ğŸ¥¤ ××©×§××•×ª</option>
   418	                        <option value="× ×™×§×™×•×Ÿ">ğŸ§¹ × ×™×§×™×•×Ÿ</option>
   419	                        <option value="×œ×ª×™× ×•×§×•×ª">ğŸ‘¶ ×œ×ª×™× ×•×§×•×ª</option>
   420	                        <option value="×©×•× ×•×ª">ğŸ“¦ ×©×•× ×•×ª</option>
   421	                    </select>
   422	                </div>
   423	                <div class="form-group">
   424	                    <label for="itemQuantity">×›××•×ª (××•×¤×¦×™×•× ×œ×™)</label>
   425	                    <input type="text" id="itemQuantity" placeholder="×œ×“×•×’××”: 2 ×œ×™×˜×¨, 500 ×’×¨×">
   426	                </div>
   427	                <div class="form-group">
   428	                    <label for="addedBy">× ×•×¡×£ ×¢×œ ×™×“×™</label>
   429	                    <input type="text" id="addedBy" placeholder="×”×©× ×©×œ×š" required>
   430	                </div>
   431	                <button type="submit" class="btn">â• ×”×•×¡×£ ×œ×¨×©×™××”</button>
   432	            </form>
   433	        </div>
   434	
   435	        <div class="filters">
   436	            <div class="filter-group">
   437	                <label for="filterCategory">×¡× ×Ÿ ×œ×¤×™ ×§×˜×’×•×¨×™×”</label>
   438	                <select id="filterCategory">
   439	                    <option value="all">×›×œ ×”×§×˜×’×•×¨×™×•×ª</option>
   440	                    <option value="×¤×™×¨×•×ª ×•×™×¨×§×•×ª">ğŸ¥¬ ×¤×™×¨×•×ª ×•×™×¨×§×•×ª</option>
   441	                    <option value="×—×œ×‘ ×•×‘×™×¦×™×">ğŸ¥› ×—×œ×‘ ×•×‘×™×¦×™×</option>
   442	                    <option value="×‘×©×¨ ×•×“×’×™×">ğŸ– ×‘×©×¨ ×•×“×’×™×</option>
   443	                    <option value="×××¤×™× ×•×œ×—×">ğŸ ×××¤×™× ×•×œ×—×</option>
   444	                    <option value="×™×‘×©×™× ×•×©×™××•×¨×™×">ğŸ¥« ×™×‘×©×™× ×•×©×™××•×¨×™×</option>
   445	                    <option value="×§×¤×•××™×">ğŸ§Š ×§×¤×•××™×</option>
   446	                    <option value="××©×§××•×ª">ğŸ¥¤ ××©×§××•×ª</option>
   447	                    <option value="× ×™×§×™×•×Ÿ">ğŸ§¹ × ×™×§×™×•×Ÿ</option>
   448	                    <option value="×œ×ª×™× ×•×§×•×ª">ğŸ‘¶ ×œ×ª×™× ×•×§×•×ª</option>
   449	                    <option value="×©×•× ×•×ª">ğŸ“¦ ×©×•× ×•×ª</option>
   450	                </select>
   451	            </div>
   452	            <div class="filter-group">
   453	                <label for="filterStatus">×¡× ×Ÿ ×œ×¤×™ ×¡×˜×˜×•×¡</label>
   454	                <select id="filterStatus">
   455	                    <option value="all">×”×›×œ</option>
   456	                    <option value="pending">×œ×§× ×•×ª</option>
   457	                    <option value="purchased">× ×¨×›×©×•</option>
   458	                </select>
   459	            </div>
   460	        </div>
   461	
   462	        <div class="items-section" id="itemsList">
   463	            <div class="loading">×˜×•×¢×Ÿ × ×ª×•× ×™×</div>
   464	        </div>
   465	
   466	        <div class="clear-section">
   467	            <button class="clear-btn" id="clearPurchased">ğŸ—‘ï¸ × ×§×” ×¤×¨×™×˜×™× ×©× ×¨×›×©×•</button>
   468	        </div>
   469	
   470	        <div class="sync-status" id="syncStatus">××¡×•× ×›×¨×Ÿ âœ“</div>
   471	    </div>
   472	
   473	    <script>
   474	        // ========================================
   475	        // ×”×’×“×¨×•×ª ×•×§×‘×•×¢×™×
   476	        // ========================================
   477	        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbyqcOeYr4weRxY2Uxzr3M8WgYOaYDBIREDqjbVCmbAE2a8BYbEjYQh-_ehVgixyFChKWg/exec';
   478	
   479	        const CATEGORIES = {
   480	            '×¤×™×¨×•×ª ×•×™×¨×§×•×ª': { emoji: 'ğŸ¥¬', color: '#28a745' },
   481	            '×—×œ×‘ ×•×‘×™×¦×™×': { emoji: 'ğŸ¥›', color: '#17a2b8' },
   482	            '×‘×©×¨ ×•×“×’×™×': { emoji: 'ğŸ–', color: '#dc3545' },
   483	            '×××¤×™× ×•×œ×—×': { emoji: 'ğŸ', color: '#fd7e14' },
   484	            '×™×‘×©×™× ×•×©×™××•×¨×™×': { emoji: 'ğŸ¥«', color: '#6c757d' },
   485	            '×§×¤×•××™×': { emoji: 'ğŸ§Š', color: '#007bff' },
   486	            '××©×§××•×ª': { emoji: 'ğŸ¥¤', color: '#ffc107' },
   487	            '× ×™×§×™×•×Ÿ': { emoji: 'ğŸ§¹', color: '#20c997' },
   488	            '×œ×ª×™× ×•×§×•×ª': { emoji: 'ğŸ‘¶', color: '#e83e8c' },
   489	            '×©×•× ×•×ª': { emoji: 'ğŸ“¦', color: '#6610f2' }
   490	        };
   491	
   492	        // ========================================
   493	        // ××©×ª× ×™× ×’×œ×•×‘×œ×™×™×
   494	        // ========================================
   495	        let allItems = [];
   496	        let filteredItems = [];
   497	        let currentFilter = {
   498	            category: 'all',
   499	            status: 'all'
   500	        };
   501	
   502	        // ========================================
   503	        // ××œ×× ×˜×™× ××”-DOM
   504	        // ========================================
   505	        const elements = {
   506	            form: document.getElementById('addItemForm'),
   507	            itemName: document.getElementById('itemName'),
   508	            itemCategory: document.getElementById('itemCategory'),
   509	            itemQuantity: document.getElementById('itemQuantity'),
   510	            addedBy: document.getElementById('addedBy'),
   511	            itemsList: document.getElementById('itemsList'),
   512	            filterCategory: document.getElementById('filterCategory'),
   513	            filterStatus: document.getElementById('filterStatus'),
   514	            clearPurchased: document.getElementById('clearPurchased'),
   515	            syncStatus: document.getElementById('syncStatus'),
   516	            totalItems: document.getElementById('totalItems'),
   517	            pendingItems: document.getElementById('pendingItems'),
   518	            purchasedItems: document.getElementById('purchasedItems')
   519	        };
   520	
   521	        // ========================================
   522	        // ×¤×•× ×§×¦×™×•×ª ×¢×–×¨
   523	        // ========================================
   524	        function showToast(message, isError = false) {
   525	            const toast = document.createElement('div');
   526	            toast.className = `toast ${isError ? 'error' : ''}`;
   527	            toast.textContent = message;
   528	            document.body.appendChild(toast);
   529	
   530	            setTimeout(() => {
   531	                toast.remove();
   532	            }, 3000);
   533	        }
   534	
   535	        function updateSyncStatus(status, message) {
   536	            elements.syncStatus.className = `sync-status ${status}`;
   537	            elements.syncStatus.textContent = message;
   538	        }
   539	
   540	        function updateStats() {
   541	            const total = allItems.length;
   542	            const purchased = allItems.filter(item => item.purchased).length;
   543	            const pending = total - purchased;
   544	
   545	            elements.totalItems.textContent = total;
   546	            elements.pendingItems.textContent = pending;
   547	            elements.purchasedItems.textContent = purchased;
   548	        }
   549	
   550	        // ========================================
   551	        // ×¤×•× ×§×¦×™×•×ª API
   552	        // ========================================
   553	        async function fetchItems() {
   554	            try {
   555	                updateSyncStatus('syncing', '××¡× ×›×¨×Ÿ...');
   556	                const response = await fetch(`${SCRIPT_URL}?action=getItems`);
   557	                
   558	                if (!response.ok) {
   559	                    throw new Error(`HTTP error! status: ${response.status}`);
   560	                }
   561	                
   562	                const data = await response.json();
   563	                
   564	                if (data.status === 'success') {
   565	                    allItems = data.items || [];
   566	                    applyFilters();
   567	                    updateStats();
   568	                    updateSyncStatus('', '××¡×•× ×›×¨×Ÿ âœ“');
   569	                } else {
   570	                    throw new Error(data.message || '×©×’×™××” ×‘×˜×¢×™× ×ª × ×ª×•× ×™×');
   571	                }
   572	            } catch (error) {
   573	                console.error('Error fetching items:', error);
   574	                updateSyncStatus('error', '×©×’×™××” ×‘×¡× ×›×¨×•×Ÿ âœ—');
   575	                showToast('×©×’×™××” ×‘×˜×¢×™× ×ª ×”×¨×©×™××”: ' + error.message, true);
   576	            }
   577	        }
   578	
   579	        async function addItem(item) {
   580	            try {
   581	                updateSyncStatus('syncing', '××•×¡×™×£ ×¤×¨×™×˜...');
   582	                
   583	                const response = await fetch(SCRIPT_URL, {
   584	                    method: 'POST',
   585	                    headers: {
   586	                        'Content-Type': 'application/json',
   587	                    },
   588	                    body: JSON.stringify({
   589	                        action: 'addItem',
   590	                        item: item
   591	                    })
   592	                });
   593	
   594	                if (!response.ok) {
   595	                    throw new Error(`HTTP error! status: ${response.status}`);
   596	                }
   597	
   598	                const data = await response.json();
   599	
   600	                if (data.status === 'success') {
   601	                    showToast('âœ“ ×”×¤×¨×™×˜ × ×•×¡×£ ×‘×”×¦×œ×—×”');
   602	                    await fetchItems();
   603	                } else {
   604	                    throw new Error(data.message || '×©×’×™××” ×‘×”×•×¡×¤×ª ×¤×¨×™×˜');
   605	                }
   606	            } catch (error) {
   607	                console.error('Error adding item:', error);
   608	                updateSyncStatus('error', '×©×’×™××” ×‘×”×•×¡×¤×” âœ—');
   609	                showToast('×©×’×™××” ×‘×”×•×¡×¤×ª ×”×¤×¨×™×˜: ' + error.message, true);
   610	            }
   611	        }
   612	
   613	        async function updateItem(index, purchased) {
   614	            try {
   615	                updateSyncStatus('syncing', '××¢×“×›×Ÿ...');
   616	
   617	                const response = await fetch(SCRIPT_URL, {
   618	                    method: 'POST',
   619	                    headers: {
   620	                        'Content-Type': 'application/json',
   621	                    },
   622	                    body: JSON.stringify({
   623	                        action: 'updateItem',
   624	                        index: index,
   625	                        purchased: purchased
   626	                    })
   627	                });
   628	
   629	                if (!response.ok) {
   630	                    throw new Error(`HTTP error! status: ${response.status}`);
   631	                }
   632	
   633	                const data = await response.json();
   634	
   635	                if (data.status === 'success') {
   636	                    showToast(purchased ? 'âœ“ ×¤×¨×™×˜ ×¡×•××Ÿ ×›× ×¨×›×©' : 'âœ“ ×¡×™××•×Ÿ ×‘×•×˜×œ');
   637	                    await fetchItems();
   638	                } else {
   639	                    throw new Error(data.message || '×©×’×™××” ×‘×¢×“×›×•×Ÿ ×¤×¨×™×˜');
   640	                }
   641	            } catch (error) {
   642	                console.error('Error updating item:', error);
   643	                updateSyncStatus('error', '×©×’×™××” ×‘×¢×“×›×•×Ÿ âœ—');
   644	                showToast('×©×’×™××” ×‘×¢×“×›×•×Ÿ ×”×¤×¨×™×˜: ' + error.message, true);
   645	            }
   646	        }
   647	
   648	        async function deleteItem(index) {
   649	            if (!confirm('×”×× ××ª×” ×‘×˜×•×— ×©×‘×¨×¦×•× ×š ×œ××—×•×§ ×¤×¨×™×˜ ×–×”?')) {
   650	                return;
   651	            }
   652	
   653	            try {
   654	                updateSyncStatus('syncing', '××•×—×§...');
   655	
   656	                const response = await fetch(SCRIPT_URL, {
   657	                    method: 'POST',
   658	                    headers: {
   659	                        'Content-Type': 'application/json',
   660	                    },
   661	                    body: JSON.stringify({
   662	                        action: 'deleteItem',
   663	                        index: index
   664	                    })
   665	                });
   666	
   667	                if (!response.ok) {
   668	                    throw new Error(`HTTP error! status: ${response.status}`);
   669	                }
   670	
   671	                const data = await response.json();
   672	
   673	                if (data.status === 'success') {
   674	                    showToast('âœ“ ×¤×¨×™×˜ × ××—×§');
   675	                    await fetchItems();
   676	                } else {
   677	                    throw new Error(data.message || '×©×’×™××” ×‘××—×™×§×ª ×¤×¨×™×˜');
   678	                }
   679	            } catch (error) {
   680	                console.error('Error deleting item:', error);
   681	                updateSyncStatus('error', '×©×’×™××” ×‘××—×™×§×” âœ—');
   682	                showToast('×©×’×™××” ×‘××—×™×§×ª ×”×¤×¨×™×˜: ' + error.message, true);
   683	            }
   684	        }
   685	
   686	        async function clearPurchasedItems() {
   687	            if (!confirm('×”×× ××ª×” ×‘×˜×•×— ×©×‘×¨×¦×•× ×š ×œ××—×•×§ ××ª ×›×œ ×”×¤×¨×™×˜×™× ×©× ×¨×›×©×•?')) {
   688	                return;
   689	            }
   690	
   691	            try {
   692	                updateSyncStatus('syncing', '×× ×§×”...');
   693	
   694	                const response = await fetch(SCRIPT_URL, {
   695	                    method: 'POST',
   696	                    headers: {
   697	                        'Content-Type': 'application/json',
   698	                    },
   699	                    body: JSON.stringify({
   700	                        action: 'clearPurchased'
   701	                    })
   702	                });
   703	
   704	                if (!response.ok) {
   705	                    throw new Error(`HTTP error! status: ${response.status}`);
   706	                }
   707	
   708	                const data = await response.json();
   709	
   710	                if (data.status === 'success') {
   711	                    showToast('âœ“ ×¤×¨×™×˜×™× ×©× ×¨×›×©×• × ×•×§×•');
   712	                    await fetchItems();
   713	                } else {
   714	                    throw new Error(data.message || '×©×’×™××” ×‘× ×™×§×•×™ ×¤×¨×™×˜×™×');
   715	                }
   716	            } catch (error) {
   717	                console.error('Error clearing purchased items:', error);
   718	                updateSyncStatus('error', '×©×’×™××” ×‘× ×™×§×•×™ âœ—');
   719	                showToast('×©×’×™××” ×‘× ×™×§×•×™ ×¤×¨×™×˜×™×: ' + error.message, true);
   720	            }
   721	        }
   722	
   723	        // ========================================
   724	        // ×¤×•× ×§×¦×™×•×ª ×ª×¦×•×’×”
   725	        // ========================================
   726	        function applyFilters() {
   727	            filteredItems = allItems.filter(item => {
   728	                const categoryMatch = currentFilter.category === 'all' || item.category === currentFilter.category;
   729	                const statusMatch = currentFilter.status === 'all' ||
   730	                    (currentFilter.status === 'pending' && !item.purchased) ||
   731	                    (currentFilter.status === 'purchased' && item.purchased);
   732	                return categoryMatch && statusMatch;
   733	            });
   734	            renderItems();
   735	        }
   736	
   737	        function renderItems() {
   738	            if (filteredItems.length === 0) {
   739	                elements.itemsList.innerHTML = `
   740	                    <div class="empty-state">
   741	                        <div class="empty-state-icon">ğŸ›’</div>
   742	                        <h2>××™×Ÿ ×¤×¨×™×˜×™× ×œ×”×¦×’×”</h2>
   743	                        <p>×”×•×¡×£ ×¤×¨×™×˜×™× ×œ×¨×©×™××” ××• ×©× ×” ××ª ×”×¡×™× ×•×Ÿ</p>
   744	                    </div>
   745	                `;
   746	                return;
   747	            }
   748	
   749	            // ×§×™×‘×•×¥ ×œ×¤×™ ×§×˜×’×•×¨×™×•×ª
   750	            const itemsByCategory = {};
   751	            filteredItems.forEach((item, index) => {
   752	                if (!itemsByCategory[item.category]) {
   753	                    itemsByCategory[item.category] = [];
   754	                }
   755	                itemsByCategory[item.category].push({ ...item, originalIndex: allItems.indexOf(item) });
   756	            });
   757	
   758	            // ×™×¦×™×¨×ª HTML
   759	            let html = '';
   760	            Object.keys(itemsByCategory).sort().forEach(category => {
   761	                const items = itemsByCategory[category];
   762	                const categoryConfig = CATEGORIES[category] || { emoji: 'ğŸ“¦', color: '#6c757d' };
   763	                
   764	                html += `
   765	                    <div class="category-group">
   766	                        <div class="category-header" style="border-right: 4px solid ${categoryConfig.color}">
   767	                            <span class="category-icon">${categoryConfig.emoji}</span>
   768	                            <span>${category}</span>
   769	                            <span class="category-count">${items.length}</span>
   770	                        </div>
   771	                `;
   772	
   773	                items.forEach(item => {
   774	                    html += `
   775	                        <div class="item ${item.purchased ? 'purchased' : ''}">
   776	                            <input type="checkbox" 
   777	                                   class="item-checkbox" 
   778	                                   ${item.purchased ? 'checked' : ''}
   779	                                   onchange="handleCheckboxChange(${item.originalIndex}, this.checked)">
   780	                            <div class="item-details">
   781	                                <div class="item-name">${item.name}</div>
   782	                                <div class="item-meta">
   783	                                    ${item.quantity ? `<span>ğŸ“¦ ${item.quantity}</span>` : ''}
   784	                                    <span>ğŸ‘¤ ${item.addedBy}</span>
   785	                                    ${item.timestamp ? `<span>ğŸ• ${formatDate(item.timestamp)}</span>` : ''}
   786	                                </div>
   787	                            </div>
   788	                            <button class="delete-btn" onclick="deleteItem(${item.originalIndex})">ğŸ—‘ï¸ ××—×§</button>
   789	                        </div>
   790	                    `;
   791	                });
   792	
   793	                html += '</div>';
   794	            });
   795	
   796	            elements.itemsList.innerHTML = html;
   797	        }
   798	
   799	        function formatDate(timestamp) {
   800	            const date = new Date(timestamp);
   801	            const today = new Date();
   802	            const yesterday = new Date(today);
   803	            yesterday.setDate(yesterday.getDate() - 1);
   804	
   805	            if (date.toDateString() === today.toDateString()) {
   806	                return '×”×™×•×';
   807	            } else if (date.toDateString() === yesterday.toDateString()) {
   808	                return '××ª××•×œ';
   809	            } else {
   810	                return date.toLocaleDateString('he-IL');
   811	            }
   812	        }
   813	
   814	        // ========================================
   815	        // ××˜×¤×œ×™ ××™×¨×•×¢×™×
   816	        // ========================================
   817	        function handleCheckboxChange(index, checked) {
   818	            updateItem(index, checked);
   819	        }
   820	
   821	        function handleFilterChange() {
   822	            currentFilter.category = elements.filterCategory.value;
   823	            currentFilter.status = elements.filterStatus.value;
   824	            applyFilters();
   825	        }
   826	
   827	        // ========================================
   828	        // ××ª×—×•×œ
   829	        // ========================================
   830	        elements.form.addEventListener('submit', async (e) => {
   831	            e.preventDefault();
   832	
   833	            const item = {
   834	                name: elements.itemName.value.trim(),
   835	                category: elements.itemCategory.value,
   836	                quantity: elements.itemQuantity.value.trim(),
   837	                addedBy: elements.addedBy.value.trim(),
   838	                purchased: false,
   839	                timestamp: new Date().toISOString()
   840	            };
   841	
   842	            await addItem(item);
   843	
   844	            // × ×™×§×•×™ ×”×˜×•×¤×¡
   845	            elements.itemName.value = '';
   846	            elements.itemQuantity.value = '';
   847	            elements.itemCategory.value = '';
   848	        });
   849	
   850	        elements.filterCategory.addEventListener('change', handleFilterChange);
   851	        elements.filterStatus.addEventListener('change', handleFilterChange);
   852	        elements.clearPurchased.addEventListener('click', clearPurchasedItems);
   853	
   854	        // ×˜×¢×™× ×” ×¨××©×•× ×™×ª
   855	        fetchItems();
   856	
   857	        // ×¨×¢× ×•×Ÿ ××•×˜×•××˜×™ ×›×œ 30 ×©× ×™×•×ª
   858	        setInterval(fetchItems, 30000);
   859	    </script>
   860	</body>
   861	</html>